[tox]
#env_list = syntax, tests, black, mypy
env_list = syntax, tests

[flake8]
max-line-length=120
exclude = .git,.tox,__pycache__,.idea,.pytest_cache
ignore=F403, F405, E722, N806, N813, E266, W503, E203, F811, E501

[pytest]
testpaths = test
asyncio_mode=auto
log_cli = true
log_cli_level = INFO

[testenv]
usedevelop = true
deps =
   -r../../requirements-all.txt
   --editable=file:///{toxinidir}/../../fixlib
   --editable=file:///{toxinidir}/../nutanix
# until this is fixed: https://github.com/pypa/setuptools/issues/3518
setenv =
    SETUPTOOLS_ENABLE_FEATURES = legacy-editable
passenv =
    NUTANIX_USER
    NUTANIX_PASSWORD

[testenv:syntax]
commands = flake8

[testenv:tests]
commands= pytest

[testenv:black]
commands = black --line-length 120 --check --diff --target-version py39 .

[testenv:mypy]
commands= python -m mypy --install-types --non-interactive --python-version 3.11 --strict fix_plugin_nutanix test
